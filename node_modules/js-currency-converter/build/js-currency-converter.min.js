!function(e){"use strict";e(["jquery"],function(e){return function(t){function r(t){T.isObject(t)&&(I=e.extend(I,t))}function n(){return I}function o(){function t(t){o=i?t:t.results,e.each(o,function(e,t){T.cacheRate(e,t.val,new Date)}),a.resolve(o)}function r(e){a.reject(e)}function n(){T.setConversionInProgress(c,null)}var o,a=e.Deferred(),c=[].slice.call(arguments).join(","),i="y"===I.API.queryParams.compact;return T.isConversionInProgress(c)?T.getConversionInProgress(c):(e.get(T.buildUrl({q:c})).done(t).fail(r).always(n),T.setConversionInProgress(c,a.promise()),a.promise())}function a(){function t(t){o.resolve(e.extend(a,t))}function r(t){e.each(c,function(e,r){T.isRateCached(r)?a[r]=T.getRateFromCache(r):o.reject(t)}),o.resolve(a)}var n=[].slice.call(arguments),o=e.Deferred(),a={},c=[];return e.each(n,function(e,t){T.isRateCachedAndNonExpired(t)?a[t]=T.getRateFromCache(t):c.push(t)}),0===c.length?o.resolve(a):(T.fetchQuote(c).done(t).fail(r),o.promise())}function c(){function t(t){e.each(t,function(e,t){t.amount=n*t.val}),a.resolve(t)}function r(e){a.reject(e)}var n=[].slice.call(arguments,0,1)[0],o=[].slice.call(arguments,1).join(","),a=e.Deferred();return T.getRate(o).done(t).fail(r),a.promise()}function i(e,t){O[e]=t}function s(e){return Boolean(T.getConversionInProgress(e))}function l(e){return O[e]}function u(e){return T.isObject(p[e])}function f(e){var t=new Date(e).getTime(),r=(new Date).getTime();return r-t>I.RATES_VALIDITY_HOURS*E}function g(e){return T.isRateCached(e)&&!T.isDateExpired(p[e].date)}function d(e,t,r){p[e]={val:t,date:r},I.CACHE_TO_LOCAL_STORAGE&&T.cacheToLocalStorage()}function A(t){var r=e.extend({},p[t]);return{val:r.val,expired:T.isDateExpired(r.date)}}function v(){T.setToLocalStorage(I.LOCAL_STORAGE_VARIABLE_NAME,p)}function C(){p=T.getFromLocalStorage(I.LOCAL_STORAGE_VARIABLE_NAME)}function R(e){return null!==e&&"object"==typeof e}function m(e,t){T.isLocalStorageAvailable()?localStorage.setItem(e,JSON.stringify(t)):console.error("Caching rates to local storage failed. Local storage not available")}function L(e){if(T.isLocalStorageAvailable())try{return JSON.parse(localStorage.getItem(e))||{}}catch(e){return{}}else console.error("Retrieving rates from local storage failed. Local storage not available")}function S(){var e="js-currency-test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function h(t){var r=I.API.url+"?",n=e.extend({},I.API.queryParams,t);return e.each(n,function(e,t,n){r+=e+"="+t+"&"}),encodeURI(r.substring(0,r.length-1))}var E=36e5,_={RATES_VALIDITY_HOURS:24,CACHE_TO_LOCAL_STORAGE:!0,LOCAL_STORAGE_VARIABLE_NAME:"JS_CURRENCY_CONVERTER_CACHED_RATES",API:{url:"http://free.currencyconverterapi.com/api/v3/convert",queryParams:{compact:"y",apiKey:""}}},I=e.extend(!0,_,t),p={},O={},T={};return T.config=r,T.getConfig=n,T.getRate=a,T.fetchQuote=o,T.convertAmount=c,T.isConversionInProgress=s,T.setConversionInProgress=i,T.getConversionInProgress=l,T.cacheToLocalStorage=v,T.cacheFromLocalStorage=C,T.isRateCachedAndNonExpired=g,T.isRateCached=u,T.isDateExpired=f,T.cacheRate=d,T.getRateFromCache=A,T.isObject=R,T.setToLocalStorage=m,T.getFromLocalStorage=L,T.isLocalStorageAvailable=S,T.buildUrl=h,I.CACHE_TO_LOCAL_STORAGE&&T.cacheFromLocalStorage(),T}})}("function"==typeof define&&define.amd?define:function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):window.CurrencyConverter=t(window.jQuery)});